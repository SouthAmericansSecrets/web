function SlideShow(elementID, slideDelay, initialDelay){ this.element = document.getElementById(elementID); this.timer = false; this.play = true; this.counter = 0; this.slideDelay = 5000; if (slideDelay) this.slideDelay = slideDelay; this.slides=[]; this.changeOpac = function(slideshow, opacity, ord) {   return ( function() {     var slide = slideshow.slides[ord];    slide.style.opacity = (opacity / 100); 	slide.style.MozOpacity = (opacity / 100);	slide.style.KhtmlOpacity = (opacity / 100); 	slide.style.filter = "alpha(opacity=" + opacity + ")";    if (opacity==100) slide.style.display="block";    if (opacity==0) slide.style.display="none";    }); }; this.displayNone = function(slideshow, ord) {   return ( function() {      //slideshow.slides[ord].style.visibility = "hidden";     slideshow.slides[ord].style.display = "none";	});  }; this.blendSlide = function(ord, millisec) {   var speed = Math.round(millisec / 100);   var timer = 0;   var slide;  if (ord==0) { // fade-in the first slide    this.slides[0].style.display = "block";    for(var i = 1; i < 101; i++) setTimeout(this.changeOpac(this,i,ord),(timer++*speed));    var functRef = this.changeOpac(this,100,1);    setTimeout(functRef,(timer*speed));  }  else { // want to fade out the slide in front or current    this.slides[ord].style.display = "block";    var functRef = this.changeOpac(this,100,ord);    var slideAhead = ord -1;    setTimeout(functRef,4);    for(var i = 99; i >= 0; i--)	  setTimeout(this.changeOpac(this,i,(slideAhead)),(timer++*speed));    var hideRef = this.displayNone(this,slideAhead);    setTimeout(hideRef,timer*speed);  } }; this.showSlide = function(ord){  this.blendSlide(ord,1500);  this.timer = false;  if (this.slides.length > 1)    this.changeSlide(this.slideDelay); }; this.timerReached = function(slideshow,ord){   return ( function(){     this.timer = true;     if (slideshow.play && slideshow.slides[ord].image.loaded)       slideshow.showSlide(ord); }	);  }; this.changeSlide = function(delay){   var ord = this.counter++ % this.slides.length;   if (!this.slides[ord].image.loaded)     this.slides[ord].image.src = this.slides[ord].image.getAttribute("ss:src");   var functRef = this.timerReached(this,ord);   setTimeout(functRef,delay); };	 this.onSlideLoad = function(e) {  e = e || window.event; var target = e.srcElement || e.target; target.loaded = true;  if (this.timer && this.play) {    var ord = parseInt(target.style.zIndex) - 6 * (-1);    this.showSlide(ord);  } };  //init  var as = this.element.getElementsByTagName("a");  for (i=0; i<as.length; i++) if (as[i].className == "slide") this.slides.push(as[i]);  for (var i=0; i<this.slides.length; i++)  {   this.slides[i].style.zIndex = "" + (this.slides.length - i );   this.slides[i].image = this.slides[i].getElementsByTagName("img")[0];   this.slides[i].image.loaded = false;   this.slides[i].image.onload = this.onSlideLoad;   this.slides[i].image.SlideShow = this;   this.slides[i].style.opacity = 0;   this.slides[i].style.MozOpacity = 0;   this.slides[i].style.KhtmlOpacity = 0;   this.slides[i].style.filter = "alpha(opacity=0)";  }  this.changeSlide(initialDelay);}